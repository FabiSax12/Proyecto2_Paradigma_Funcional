<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Proyecto2_Lenguajes.GUI.ViewModels"
        xmlns:converters="using:Proyecto2_Lenguajes.GUI.Converters"
        x:Class="Proyecto2_Lenguajes.GUI.Views.AhorcadoWindow"
        x:DataType="vm:AhorcadoViewModel"
        Title="Juego del Ahorcado"
        Width="600" Height="550"
        WindowStartupLocation="CenterScreen"
        CanResize="False">

    <Window.Resources>
        <converters:IntToVisibilityConverter x:Key="IntToVisibilityConverter" />
    </Window.Resources>

    <Design.DataContext>
        <vm:AhorcadoViewModel/>
    </Design.DataContext>

    <Grid Margin="20" RowDefinitions="Auto, *, Auto, Auto" ColumnDefinitions="250, *">

        <!-- Columna 0: Stickman -->
        <Canvas Grid.Row="0" Grid.RowSpan="4" Width="200" Height="350" HorizontalAlignment="Center" VerticalAlignment="Top">
            <!-- Horca -->
            <Line StartPoint="20,330" EndPoint="180,330" Stroke="Black" StrokeThickness="4" />
            <Line StartPoint="60,330" EndPoint="60,50" Stroke="Black" StrokeThickness="4" />
            <Line StartPoint="60,50" EndPoint="140,50" Stroke="Black" StrokeThickness="4" />
            <Line StartPoint="140,50" EndPoint="140,90" Stroke="Black" StrokeThickness="2" />

            <!-- Stickman (controlado por visibilidad) -->
            <!-- Cabeza (Error 1) -->
            <Ellipse Canvas.Left="120" Canvas.Top="90" Width="40" Height="40" Stroke="Black" StrokeThickness="3"
                     IsVisible="{Binding ErroresCometidos, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=1}" />
            <!-- Cuerpo (Error 2) -->
            <Line StartPoint="140,130" EndPoint="140,220" Stroke="Black" StrokeThickness="3"
                  IsVisible="{Binding ErroresCometidos, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=2}" />
            <!-- Brazo Izquierdo (Error 3) -->
            <Line StartPoint="140,150" EndPoint="100,190" Stroke="Black" StrokeThickness="3"
                  IsVisible="{Binding ErroresCometidos, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=3}" />
            <!-- Brazo Derecho (Error 4) -->
            <Line StartPoint="140,150" EndPoint="180,190" Stroke="Black" StrokeThickness="3"
                  IsVisible="{Binding ErroresCometidos, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=4}" />
            <!-- Pierna Izquierda (Error 5) -->
            <Line StartPoint="140,220" EndPoint="100,280" Stroke="Black" StrokeThickness="3"
                  IsVisible="{Binding ErroresCometidos, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=5}" />
            <!-- Pierna Derecha (Error 6) -->
            <Line StartPoint="140,220" EndPoint="180,280" Stroke="Black" StrokeThickness="3"
                  IsVisible="{Binding ErroresCometidos, Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=6}" />
        </Canvas>

        <!-- Columna 1: LÃ³gica del juego -->
        <TextBlock Grid.Row="0" Grid.Column="1" Text="Juego del Ahorcado" FontSize="28" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,20" />

        <StackPanel Grid.Row="1" Grid.Column="1" Spacing="15" VerticalAlignment="Center">
            <TextBlock Text="{Binding PalabraMostrada}" FontSize="36" FontWeight="Bold" LetterSpacing="8" HorizontalAlignment="Center"/>
            <TextBlock Text="Letras usadas:" FontSize="14" Margin="0,20,0,0"/>
            <TextBlock Text="{Binding LetrasUsadas}" FontSize="16" Foreground="DarkSlateGray" TextWrapping="Wrap"/>
            <TextBlock Text="{Binding IntentosRestantes, StringFormat='Intentos restantes: {0}'}" FontSize="16" FontWeight="SemiBold"/>
        </StackPanel>

        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center" IsVisible="{Binding JuegoActivo}">
            <TextBox Name="InputLetra" Width="50" MaxLength="1" FontSize="20" TextAlignment="Center"/>
            <Button Content="Intentar" FontSize="18" Padding="15,5"
                    Command="{Binding IntentarLetraCommand}"
                    CommandParameter="{Binding #InputLetra.Text}"/>
        </StackPanel>
        
        <StackPanel Grid.Row="3" Grid.Column="1" Spacing="10" HorizontalAlignment="Center" Margin="0,20,0,0">
            <TextBlock Text="{Binding MensajeFinal}" FontSize="20" FontWeight="Bold" Foreground="ForestGreen" HorizontalAlignment="Center"/>
            <Button Content="Nuevo Juego" FontSize="18" Padding="15,5" IsVisible="{Binding !JuegoActivo}" Command="{Binding NuevoJuegoCommand}"/>
        </StackPanel>
    </Grid>
</Window>
